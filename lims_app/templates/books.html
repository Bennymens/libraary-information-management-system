{% extends "index.html" %}
{% block main_content %}
<style>
  .book-card {
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    max-width: 320px;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    height: 100%;
  }
.book-card:hover {
  transform: translateY(-8px);
}
.book-cover img, .book-cover-placeholder {
  width: 100%;
  height: 220px;
  object-fit: cover;
  background: #eee;
  display: block;
}
.book-cover-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  color: #888;
  font-size: 1rem;
}
.book-info {
  padding: 18px;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}
.book-title {
  font-size: 1.2rem;
  font-weight: bold;
  margin-bottom: 6px;
  color: #222;
}
.book-author {
  font-size: 0.95rem;
  color: #666;
  margin-bottom: 10px;
}
.book-genre {
  display: inline-block;
  background: #eee;
  color: #444;
  font-size: 0.8rem;
  padding: 4px 10px;
  border-radius: 12px;
  margin-bottom: 14px;
}
.book-summary {
  font-size: 0.9rem;
  color: #444;
  line-height: 1.4;
  margin-bottom: 18px;
  flex: 1 1 auto;
}
.read-btn {
  display: inline-block;
  text-decoration: none;
  background: #ff6b35;
  color: #fff !important;
  padding: 10px 18px;
  border-radius: 25px;
  font-weight: bold;
  transition: background 0.3s ease;
  text-align: center;
  font-size: 0.95rem;
  margin-bottom: 8px;
}
.read-btn:hover, .read-btn:focus {
  background: #e45a27;
  color: #fff !important;
}
@media (max-width: 767.98px) {
  .book-card {
    max-width: 320px;
    width: 90vw;
    min-width: 0;
    margin-left: auto;
    margin-right: auto;
  }
  .book-cover img, .book-cover-placeholder { height: 140px; }
  .book-info { padding: 10px; }
}
</style>
<div class="container mt-3">
    <h3 style="font-size:1.1rem;">Library Books</h3>
    <form method="get" class="mb-3">
        <div class="row g-2 align-items-center">
            <div class="col-auto">
                <label for="genre" class="form-label mb-0" style="font-size:0.95rem;">Genre:</label>
            </div>
            <div class="col-auto">
                <select name="genre" id="genre" class="form-select form-select-sm" style="font-size:0.95rem;" onchange="this.form.submit()">
                    <option value="">All Genres</option>
                    {% for value, label in genres %}
                        <option value="{{ value }}" {% if selected_genre == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </form>
    <div class="row">
        {% for book in books %}
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4 d-flex justify-content-center">
            <div class="book-card">
                <div class="book-cover">
                    {% if book.cover %}
                        <img src="{{ book.cover.url }}" alt="Cover of {{ book.title }}">
                    {% else %}
                        <div class="book-cover-placeholder">No Cover</div>
                    {% endif %}
                </div>
                <div class="book-info d-flex flex-column h-100">
                    <h2 class="book-title">{{ book.title }}</h2>
                    <p class="book-author">by {{ book.author }}</p>
                    <span class="book-genre">{{ book.get_genre_display }}</span>
                    <p class="book-summary">{{ book.description|truncatewords:18 }}</p>
                    {% if book.file %}
                        <a href="{{ book.file.url }}" class="read-btn">ðŸ“– Read Book</a>
                    {% else %}
                        <button class="read-btn" style="background:#bbb;cursor:not-allowed;" disabled>No File</button>
                    {% endif %}
                    {% if book.available %}
                        <span class="badge bg-success w-100" style="font-size:0.8rem;">Available</span>
                    {% else %}
                        <span class="badge bg-secondary w-100" style="font-size:0.8rem;">Borrowed</span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <p>No books in this genre yet.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}